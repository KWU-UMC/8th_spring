# 외래키란?

  ### 정의

    - **외래키(Foreign Key)**: 한 테이블의 특정 컬럼이 다른 테이블의 기본키(Primary Key, PK) 를 참조하는 키
    - 데이터의 일관성을 보장하고 부적절한 데이터 입력을 방지하는 역할을 함.(참조 무결성 유지)
    - 이때 FK는 반드시 부모테이블의 PK를 참조해야 함.

  ### **특징**

    - 한 테이블에 여러 개의 외래키를 가질 수 있음
    - FK 컬럼은 부모 테이블의 PK와 데이터 타입이 일치해야 함
    - JOIN 연산 최적화에 유리함 →  외래키가 설정되면, 데이터베이스가 인덱스를 자동으로 만들어 줌
    - **INSERT/DELETE 순서 주의**
        - 부모 테이블의 데이터가 존재해야 자식 테이블에 데이터를 삽입할 수 있음
        - 자식 테이블의 데이터가 남아 있으면 부모 테이블의 데이터를 삭제할 수 없음 (RESTRICT)


# 기본키란?

    <aside>
    💡

  ### 정의

    - **기본키(Primary Key)**는 데이터베이스 설계 시 필수적인 요소로, 각 행(row)를 고유하게 식별하는 데 사용되는 하나 이상의 컬럼으로 구성됨.
    - 데이터 무결성 유지하고, 테이블 내에서 중복된 데이터를 방지하는 역할을 함
    - 다른 테이블과의 관계를 설명하는 데에 핵심적인 역할을 수행함.
    </aside>

  ### 특징

    1. 유일성: 각 행을 고유하게 식별해야 하므로 PK 값은 테이블 내에서 중복될 수 없음
    2. Not Null: 기본키 컬럼은 반드시 값을 가져야하므로, Null 값을 허용하지 않음.
    3. 불변성(Immutability): PK는 데이터의 무결성을 유지하기 위해 한 번 설정되면 변경되지 않는 것이 좋음.
    4. 단일 or 복합 키: PK는 하나의 컬럼으로 구성될 수도 있고, 여러 컬럼의 조합으로 구성될 수도 있음.
        1. 복합키는 밑에 정리되어있음
    5. 데이터 검색 및 성능 향상**:** 기본키는 인덱스로 자동 생성되어 데이터 검색 속도를 향상시키고, 쿼리 성능을 최적화 할 수 있음.

  ### 고려사항

    - 기본키는 의미없는 값을 사용하는 것이 좋음(ex. id값 사용) → 데이터 변경에 따른 영향을 최소화 할 수 있음

- ER 다이어그램

  # ER 다이어그램이란?

    <aside>
    💡

  ## 정의

    - ER 다이어그램(Entity Relationship Diagram)은 데이터베이스 설계 시 엔터티와 그룹 간의 관계를 시각적으로 표현한 다이어그램
    </aside>

  ## 구성요소

    1. 엔터티(Entity)
        - 시스템에서 독립적으로 존재하는 식별 가능한 개체
        - Ex. 학생, 강의, 교수
    2. Attribute
        - 엔터티가 가지는 속성
        - Ex. 학생 엔터티에서 → 학번, 이름, 생년월일 등
    3. 관계(Relationship):
        - 엔터티 간의 연관성
        - Ex. 학생 ↔ 강의 관계: 수강한다
        - 연관관계에 대한 자세한 설명은 밑에 따로 정리
        - 관련된 표기

    1. Cardinality:
        - 한 엔터티와 다른 엔터티가 갖는 관계의 수
        - Ex. 1:1, 1:N, N:M, 지도교수와 학생의 관계는 1:N

  ## 고려사항

    - 각 엔터티는 고유하게 식별 가능해야함
    - 데이터의 중복을 최소화하고 일관성을 유지하기 위해 **정규화를 고려해야함**

# 복합 키란?

    <aside>
    💡

  ## 정의

    - 두 개 이상의 컬럼을 조합하여 하나의 기본 키(PK)로 설정하는 것
    - 단일 컬럼만으로 각 row를 식별하기 어려울 때 주로 사용함
    </aside>

  ## 특징

    1. 유일성(Unique): 기본키이므로 유일성을 가지며, 조합된 컬럼들의 값이 결합돼서 테이블 내에서 각 행을 고유하게 식별하는 데에 작용함.
    2. 데이터 무결성 유지(기본키와 동일한 특징)

  ## 고려사항

    - 복합 키 사용시 컬럼 순서를 고려해야함.  카디널리티가 높은 컬럼을 먼저 배치하는 것이 좋음. (이때의 카디널리티는 ERD에서와 다름. 컬럼에 존재하는 고유한 값들의 개수임.)
    - 쿼리 작성 및 유지보수가 복잡해질 수 있다는 점을 고려해야함.

# 연관관계란?

    <aside>
    💡

  ## 정의

    - 두 개 이상의 테이블 간에 존재하는 관계
    - 데이터 구조화, 무결성을 유지하는 데에 필수적임
    </aside>

  ## 구성요소

  ### 관계 유형

    1. 일대일 관계(1:1)
        - 한 테이블의 각 행이 다른 테이블의 단일 행과만 연결
        - Ex. 학생 테이블과 학생의 수강신청 즐겨찾기 테이블
    2. 일대다 관계(1:N)
        - 한 테이블의 각 행이 다른 테이블의 여러 행과 연결
        - Ex. 학과 테이블의 한 학과와 학생 테이블
    3. 다대다 관계(N:M)
        - 한 테이블의 여러 행이 다른 테이블의 여러 행과 연결
        - Ex. 학생 테이블과 강의 테이블의 관계  → 한 학생이 여러 강의 수강, 한 강의에 여러 학생 참여 → 일반적으로 조인 테이블을 통해 구현됨

  ### 관계의 방향성

    1. 단방향 관계
        - 한 테이블이 다른 테이블을 참조하지만 반대는 성립 X
        - Ex. 주문 테이블이 고객 테이블을 참조하지만, 고객 테이블은 주문 테이블을 참조하지 않음
    2. 양방향 관계
        - 두 테이블이 서로를 참조
        - Ex. 학생 테이블과 강의 테이블

  ## 고려사항

    - 데이터 무결성 유지를 위해 외래 키 사용

# 정규화 

## 논리적 데이터베이스 설계
    
    1. ER 스키마(비정규 릴레이션이므로 삽입, 삭제, 갱신 시 이상이 생길 수 있음)
        
         → 따라서 이를 관계 스키마로 변경
        
    2. 효율적인 데이터베이스 스키마 구축을 위해 정규화(Normalization)
        
        
    
# 정규화(Normalization)란?
    
<aside>
    💡
    
## 정의
    
- 함수적 종속성을 이용하여 테이블을 계속해서 분해해 나가는 과정
    </aside>
    
    ## 목적
    
    - 데이터 구조의 안정성 최대화
    - 중복 배제하여 삽입, 삭제, 갱신 이상 발생 방지
    - 삽입 시 릴레이션 재구성할 필요 줄이고, 효과적인 검색을 가능하게 함.
    
    ## 정규화 단계
    
    1. **1정규형(1NF):** 모든 속성은 원자값을 가져야 함. 
        - **정규화 안 된 테이블 (1NF 위반)**
            
            
| 주문 ID | 상품명 |
| --- | --- |
| 1 | 사과, 바나나 |
| 2 | 포도 |
- **1NF 적용 (컬럼을 나눠서 원자값으로 저장)**
            
            
| 주문 ID | 상품명 |
| --- | --- |
| 1 | 사과 |
| 1 | 바나나 |
| 2 | 포도 |
2. **2정규형(2NF):** 부분 함수 종속성을 제거하고, 완전 함수 종속성을 갖도록 함.
- **정규화 안 된 테이블 (부분 종속성 존재)**
- 기본키가 `주문 ID + 상품명`이라면, `공급업체`는 상품명에만 의존함 → 부분 종속성 발생 🚨
            
| 주문 ID | 상품명 | 공급업체 |
| --- | --- | --- |
| 1 | 사과 | A회사 |
| 2 | 바나나 | B회사 |
- **2NF 적용 (부분 종속성 제거)**
            
### **💡 주문 테이블**
            
| 주문 ID | 상품명 |
            | --- | --- |
            | 1 | 사과 |
            | 2 | 바나나 |
            
### **💡 상품 테이블**
            
| 상품명 | 공급업체 |
            | --- | --- |
            | 사과 | A회사 |
            | 바나나 | B회사 |
3. **3정규형(3NF):** 이행적 함수 종속성을 제거
4. **보이스-코드 정규형(BCNF):** 모든 결정자는 후보 키여야 함.
5. **4정규형(4NF):** 다치 종속성을 제거함.
6. **5정규형(5NF):** 조인 종속성을 이용함.


# 반 정규화(Denormalization)란?

<aside>

## 💡 정의

시스템 성능 향상과 개발 및 운영의 편의성을 위해, 의도적으로 정규화된 데이터 모델의 원칙을 위배하여 데이터를 통합, 중복, 분리하는 과정

</aside>

## **특징**

    1. 성능 향상: 데이터 조회 시 JOIN 연산을 줄여 응답 시간을 단축
    2. 개발 및 운영의 편의성: 테이블 구조가 단순화되어 개발과 유지보수가 용이해짐
    3. 데이터 중복 증가: 데이터를 중복 저장하므로 저장 공간이 증가하고, 데이터 일관성 유지가 어려워질 수 있음

  ## 반 정규화 단계

1. 테이블 통합**:**
        - 자주 함께 조회되는 1:1 또는 1:N 관계의 테이블을 하나로 합침
        - JOIN 연산을 줄여 조회 성능을 향상
        - 데이터 중복으로 인해 삽입, 수정, 삭제 시 이상 현상이 발생할 수 있음
2. 테이블 분할:
    - 테이블을 수평 또는 수직으로 분할하여 데이터 접근 성능을 최적화함
        - 수평 분할: 레코드를 기준으로 분할하여 특정 범위의 데이터 접근을 최적화합니다.
        - 수직 분할: 컬럼을 기준으로 분할하여 자주 사용되는 속성만을 포함한 테이블을 생성합니다.
3. 중복 컬럼 추가:
    - 다른 테이블에 있는 속성을 현재 테이블에 추가하여 데이터 중복을 허용합니다.
    - JOIN 없이도 필요한 데이터를 조회할 수 있어 성능이 향상됨
    - 일관성 유지가 어려울 수 있음
   4. 중복 테이블 추가:
       - 집계 데이터나 이력 데이터를 별도의 테이블로 생성해서 관리함
       - 특정 작업의 효율성을 향상
       - 데이터 중복으로 인한 저장 공간 증가와 데이터 일관성 문제가 발생할 수 있음