## **지연로딩과 즉시로딩의 차이**

**즉시로딩**

💡방식

- 엔티티를 조회할 때 연관된 모든 엔티티를 함께 조회
- `@ManyToOne(fetch = FetchType.EAGER)`

💡 특징

 - 조회 즉시 모든 연관 객체를 사용할 수 있어 코드가 직관적임

💡 주의해야 할 점

- 복잡한 연관 관계에서는 N+1 문제 발생 가능성
- 연관된 데이터가 많을 경우 불필요한 데이터까지 한번에 조회되어 성능 저하



**지연로딩**

💡방식

- 엔티티만 먼저 조회하고 연관된 엔티티는 **실제로 접근할 때 프록시 객체를 통해 로딩**
- `@OneToMany(fetch = FetchType.LAZY)`

💡 특징

- 처음에는 실제 객체 대신 프록시 객체가 할당됨
- 프록시는 실제 객체처럼 보이지만 내부적으로는 실제 데이터에 접근하기 전까지는 DB 쿼리를 실행하지 않음
- 불필요한 데이터를 미리 로딩하지 않아 메모리 사용 효율이 높음

💡 주의해야 할 점

- 연관 객체에 반복적으로 접근하면 쿼리가 N+1 문제가 발생할 수 있음

##  **Fetch Join**

💡개념

- JPA의 JPQL에서 연관된 엔티티를 함께 즉시 로딩하도록 하는 조인 방식
- 기본적으로 JPA는 연관 관계에 LAZY로딩을 많이 사용하지만 이로 인해 발생하는 N+1 문제를 해결하기 위해 Fetch Join이 사용

💡방식

- JPQL에서 `JOIN FETCH` 구문을 사용해 연관된 엔티티를 함께 조회함
- 쿼리 실행 시, 연관된 엔티티도 즉시 로딩되어 프록시가 아닌 실제 객체로 채워짐
- 결과적으로 하나의 쿼리로 주엔티티와 연관 엔티티를 모두 가져올 수 있음

💡장점

- N+1문제를 해결할 수 있음

💡주의해야 할 점

 - 별칭을 줄 수 없다.
 - 둘 이상의 컬렉션은 Fetch Join 할 수 없다.
 - 컬렉션을 Fetch Join하면 페이징을 사용할 수 없다.
##  **@EntityGraph**

💡 개념

- JPA에서 연관 엔티티를 fetch join 방식으로 조회할 수 있도록 도와주는 어노테이션

💡 특징

- 복잡한 JPQL 없이도 fetch join 효과를 낼 수 있어 코드가 간결하고 가독성이 향상됨

💡 사용하는 방법

- Repository의 메서드에 직접 선언하여 사용
- fetch join 하고자 하는 연관 필드를 `attributePaths` 속성에 명시하면 해당 엔티티를 조회할 때 fetch join 방식으로 함께 로딩됨

💡 주의해야 할 점

- left outer join 만을 지원한다

## **JPQL**

  💡 개념

- JPA에서 사용하는 객체 지향 쿼리 언어

💡 네이티브 쿼리와 차이

  | 항목 | **JPQL** | **Native Query** |
      | --- | --- | --- |
  | **정의** | 엔티티를 대상으로 작성하는 JPA 전용 쿼리 언어 | 데이터베이스의 테이블을 대상으로 작성하는 SQL |
  | **DB 종속성** | DB에 독립적 (이식성 높음) | DB에 종속적 (특정 DB 문법 사용 가능) |
  | **표현 방식** | 객체 기반 추상화된 쿼리 언어 | 데이터베이스 친화적인 SQL 문법 그대로 사용 |
  | **성능 및 유연성** | 일부 제한 존재, 성능 튜닝에 한계 있음 | SQL 전체 기능 사용 가능, 성능 최적화에 유리 |

## **QueryDSL**

💡 개념

- 타입 안전성을 보장하는 자바 기반의 쿼리 빌더 라이브러리 
- JPA와 SQL 쿼리를 동적이고 안전하게 생성할 수 있도록 도와주는 도구

💡 특징

**타입 안정성**

정적 타입을 기반으로 쿼리를 작성하기 때문에, 컴파일 타임에 오류를 검출할 수 있어 런타임 오류 최소화

**동적 쿼리 작성 용이**

조건이 동적으로 변하는 쿼리를 작성할 때 조건을 유연하게 추가, 삭제할 수 있다.


💡 동적 쿼리 작성 방법
    
**BooleanBuilder**
- **여러 조건을 동적으로 조합**하기 위한 빌더 클래스
- 조건을 추가할 때 **`and()`**, **`or()`** 등의 논리 연산을 사용하여 조건을 연결할 수 있음

**Where 다중 파라미터**
- 여러 파라미터를 이용해 **조건을 동적으로 변경**하며 쿼리를 작성
- **`where()`** 구문을 사용하여 **여러 조건을 묶어 동적으로 처리함**